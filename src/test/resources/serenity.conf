serenity.test.root = webtests

environment = run_on_browserstack

environments {
  run_on_lambdatest {
    tags = "not local"
    serenity.extension.packages = "webtests.lambdatest"
    webdriver {
      driver = remote
      remote.url = "https://#{lambdatest.user}:#{lambdatest.key}@hub.lambdatest.com/wd/hub"

      platform = "Windows 10"
      browserName = "Chrome"
      version = "92.0"
      resolution = "1024x768"
      network = true
      visual = true
      video = true
      console = true
    }
  }

  run_on_browserstack {
    tags = "not local"

    webdriver {
      driver = remote
      remote.url = "https://#{browserstack.user}:#{browserstack.key}@hub-cloud.browserstack.com/wd/hub"

      browserstack {
          os = "Windows"
          os_version = "10"
          browser = "Edge"
          browser_version = "latest"
          resolution = "1280x1024"
      }
    }
  }

  run_on_saucelabs {

    webdriver {
      driver = remote
      remote.url = "https://#{saucelabs.username}:#{saucelabs.accessKey}@#{saucelabs.datacenter}.saucelabs.com:443/wd/hub"
    }
    saucelabs {
      platformName = "Windows 10"
      browserName = "MicrosoftEdge"
      browserVersion = "latest"

      tags = ["end-to-end"]
      maxDuration = 900
      capturePerformance = true
      extendedDebugging = true
    }
  }

  run_on_lambdatest {
    tags = "not local"
    serenity.extension.packages = "webtests.lambdatest"
    webdriver {
      driver = remote
      remote.url = "https://#{lambdatest.user}:#{lambdatest.key}@hub.lambdatest.com/wd/hub"

      platform = "Windows 10"
      browserName = "Chrome"
      version = "92.0"
      resolution ="1024x768"
      network = true
      visual = true
      video = true
      console = true
    }
  }

  grid {
    webdriver {
      driver = remote
      remote.url = "http://127.0.0.1:4444/wd/hub"
      browserName = "firefox"
      screenResolution = "1280x1024"
      unhandledPromptBehavior = "ignore"
    }
  }


  local {
    webdriver.driver = chrome
    chrome {
      # driver = $HOME/some/other/path/to/chrome/binary

      switches = [
        "--start-maximized",
        "--accept-insecure-certs",
        # Commented lined like this are ignored
        //        "window-size=800,600",
        "--disable-popup-blocking",
        "--ignore-certificate-errors",
        "--disable-infobars"
        "--disable-gpu"
      ]

      # See all the preference options here: https://chromedriver.chromium.org/capabilities
      preferences {
        download {
          prompt_for_download: false
          default_directory: "$TEMPDIR"
        }
      }
    }
  }
}